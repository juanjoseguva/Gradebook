{"ast":null,"code":"import React,{useState,useEffect}from'react';import{confirmAlert}from'react-confirm-alert';// Import\nimport'react-confirm-alert/src/react-confirm-alert.css';// Import css\nimport UserUpdate from'./UserUpdate';import UserAdd from'./UserAdd';import Button from'@mui/material/Button';import{SERVER_URL}from'../../Constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function UsersView(props){const headers=['ID','Name','Email','Type','',''];const[users,setUsers]=useState([]);const[message,setMessage]=useState('');const fetchUsers=async()=>{try{const jwt=sessionStorage.getItem('jwt');const response=await fetch(\"\".concat(SERVER_URL,\"/users\"),{method:'GET',headers:{'Authorization':jwt}});if(response.ok){const users=await response.json();setUsers(users);}else{const json=await response.json();setMessage(\"response error: \"+json.message);}}catch(err){setMessage(\"network error: \"+err);}};useEffect(()=>{fetchUsers();},[]);const saveUser=async user=>{try{const jwt=sessionStorage.getItem('jwt');const response=await fetch(\"\".concat(SERVER_URL,\"/users\"),{method:'PUT',headers:{'Content-Type':'application/json','Authorization':jwt},body:JSON.stringify(user)});if(response.ok){setMessage(\"user saved\");fetchUsers();}else{const rc=await response.json();setMessage(rc.message);}}catch(err){setMessage(\"network error: \"+err);}};const addUser=async user=>{try{const jwt=sessionStorage.getItem('jwt');const response=await fetch(\"\".concat(SERVER_URL,\"/users\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':jwt},body:JSON.stringify(user)});if(response.ok){const newuser=await response.json();setMessage(\"user added id=\"+newuser.id);fetchUsers();}else{const rc=await response.json();setMessage(rc.message);}}catch(err){setMessage(\"network error: \"+err);}};const deleteUser=async id=>{try{const jwt=sessionStorage.getItem('jwt');const response=await fetch(\"\".concat(SERVER_URL,\"/users/\").concat(id),{method:'DELETE',headers:{'Content-Type':'application/json','Authorization':jwt}});if(response.ok){setMessage(\"User deleted\");fetchUsers();}else{const rc=await response.json();setMessage(rc.message);}}catch(err){setMessage(\"network error: \"+err);}};const onDelete=e=>{const row_idx=e.target.parentNode.parentNode.rowIndex-1;const id=users[row_idx].id;confirmAlert({title:'Confirm to delete',message:'Do you really want to delete?',buttons:[{label:'Yes',onClick:()=>deleteUser(id)},{label:'No'}]});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Users\"}),/*#__PURE__*/_jsx(\"h4\",{children:message}),/*#__PURE__*/_jsxs(\"table\",{className:\"Center\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:headers.map((s,idx)=>/*#__PURE__*/_jsx(\"th\",{children:s},idx))})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(user=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:user.id}),/*#__PURE__*/_jsx(\"td\",{children:user.name}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsx(\"td\",{children:user.type}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(UserUpdate,{user:user,save:saveUser})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{onClick:onDelete,children:\"Delete\"})})]},user.id))})]}),/*#__PURE__*/_jsx(UserAdd,{save:addUser})]});}export default UsersView;","map":{"version":3,"names":["React","useState","useEffect","confirmAlert","UserUpdate","UserAdd","Button","SERVER_URL","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","UsersView","props","headers","users","setUsers","message","setMessage","fetchUsers","jwt","sessionStorage","getItem","response","fetch","concat","method","ok","json","err","saveUser","user","body","JSON","stringify","rc","addUser","newuser","id","deleteUser","onDelete","e","row_idx","target","parentNode","rowIndex","title","buttons","label","onClick","children","className","map","s","idx","name","email","type","save"],"sources":["/home/juangutierrez/Documents/CST438 - Software Engineering/Gradebook/frontRest/cst438_Assign3/src/components/admin/UsersView.js"],"sourcesContent":["import React, {useState, useEffect} from 'react';\nimport { confirmAlert } from 'react-confirm-alert'; // Import\nimport 'react-confirm-alert/src/react-confirm-alert.css'; // Import css\nimport UserUpdate from './UserUpdate';\nimport UserAdd from './UserAdd';\nimport Button from '@mui/material/Button';\nimport {SERVER_URL} from '../../Constants';\n\nfunction UsersView(props) {\n    const headers = ['ID', 'Name', 'Email', 'Type', '', ''];\n\n    const [users, setUsers] = useState([  ]);\n\n    const [message, setMessage] = useState('');\n\n    const  fetchUsers = async () => {\n        try {\n            const jwt = sessionStorage.getItem('jwt');\n            const response = await fetch(\n                `${SERVER_URL}/users`,\n                {\n                    method: 'GET',\n                    headers: {\n                        'Authorization': jwt\n                    }\n                });\n            if (response.ok) {\n                const users = await response.json();\n                setUsers(users);\n            } else {\n                const json = await response.json();\n                setMessage(\"response error: \"+json.message);\n            }\n        } catch (err) {\n            setMessage(\"network error: \"+err);\n        }\n    }\n\n    useEffect( () => {\n        fetchUsers();\n    }, []);\n\n    const saveUser = async (user) => {\n        try {\n            const jwt = sessionStorage.getItem('jwt');\n            const response = await fetch(`${SERVER_URL}/users`,\n                {\n                    method: 'PUT',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': jwt\n                    },\n                    body: JSON.stringify(user),\n                });\n            if (response.ok) {\n                setMessage(\"user saved\")\n                fetchUsers();\n            } else {\n                const rc = await response.json();\n                setMessage(rc.message);\n            }\n        } catch (err) {\n            setMessage(\"network error: \"+err);\n        }\n    }\n\n    const addUser = async (user) => {\n        try {\n            const jwt = sessionStorage.getItem('jwt');\n            const response = await  fetch(`${SERVER_URL}/users`,\n                {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': jwt\n                    },\n                    body: JSON.stringify(user),\n                });\n            if (response.ok) {\n                const newuser = await response.json();\n                setMessage(\"user added id=\"+newuser.id);\n                fetchUsers();\n            } else {\n                const rc = await response.json();\n                setMessage(rc.message);\n            }\n        } catch (err) {\n            setMessage(\"network error: \"+err);\n        }\n    }\n\n    const deleteUser = async (id) => {\n        try {\n            const jwt = sessionStorage.getItem('jwt');\n            const response = await fetch(`${SERVER_URL}/users/${id}`,\n                {\n                    method: 'DELETE',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': jwt\n                    },\n                });\n            if (response.ok) {\n                setMessage(\"User deleted\");\n                fetchUsers();\n            } else {\n                const rc = await response.json();\n                setMessage(rc.message);\n            }\n        } catch (err) {\n            setMessage(\"network error: \"+err);\n        }\n    }\n\n\n    const onDelete = (e) => {\n        const row_idx = e.target.parentNode.parentNode.rowIndex - 1;\n        const id = users[row_idx].id;\n        confirmAlert({\n            title: 'Confirm to delete',\n            message: 'Do you really want to delete?',\n            buttons: [\n                {\n                    label: 'Yes',\n                    onClick: () => deleteUser(id)\n                },\n                {\n                    label: 'No',\n                }\n            ]\n        });\n    }\n\n    return(\n        <>\n            <h3>Users</h3>\n            <h4>{message}</h4>\n            <table className=\"Center\" >\n                <thead>\n                <tr>\n                    {headers.map((s, idx) => (<th key={idx}>{s}</th>))}\n                </tr>\n                </thead>\n                <tbody>\n                {users.map((user) => (\n                    <tr key={user.id}>\n                        <td>{user.id}</td>\n                        <td>{user.name}</td>\n                        <td>{user.email}</td>\n                        <td>{user.type}</td>\n                        <td><UserUpdate user={user} save={saveUser} /></td>\n                        <td><Button onClick={onDelete}>Delete</Button></td>\n                    </tr>\n                ))}\n                </tbody>\n            </table>\n            <UserAdd save={addUser} />\n        </>\n    );\n}\nexport default UsersView;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}